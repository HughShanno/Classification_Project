{"backend_state":"running","kernel":"python3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":79896576},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.3"}},"type":"settings"}
{"cell_type":"code","exec_count":1,"id":"2d3645","input":"#insert 2","pos":10,"type":"cell"}
{"cell_type":"code","exec_count":1,"id":"3931be","input":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pylab as plt\n%matplotlib inline\nfrom matplotlib.colors import ListedColormap\nimport matplotlib.cm as cm\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import LogisticRegressionCV\nfrom sklearn import naive_bayes\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import KFold\nfrom sklearn import svm\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\n\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neural_network import MLPClassifier\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import make_pipeline\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nfrom sklearn.metrics import roc_curve, roc_auc_score, average_precision_score\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.metrics import precision_score, recall_score\n\nfrom itertools import product\n\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\n\nfrom scipy.stats import mode","pos":0,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"01b832","input":"#insert 3","pos":12,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"2993c5","input":"df = pd.read_csv('data/schools.csv', index_col = 0)\nprint(df.shape)\ndf.head()","output":{"0":{"name":"stdout","output_type":"stream","text":"(6740, 46)\n"},"1":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>ownership</th>\n      <th>ope6_id</th>\n      <th>state</th>\n      <th>size</th>\n      <th>accreditor</th>\n      <th>retention</th>\n      <th>branches</th>\n      <th>online_only</th>\n      <th>religious_affil</th>\n      <th>...</th>\n      <th>fafsa_sent</th>\n      <th>7_yr_repayment_completion</th>\n      <th>5_year_declining_balance</th>\n      <th>relig_y_n</th>\n      <th>accred_y_n</th>\n      <th>retention_listed_y_n</th>\n      <th>fac_salary_listed_y_n</th>\n      <th>7_yr_repayment_completion_y_n</th>\n      <th>5_year_declining_balance_y_n</th>\n      <th>for_profit</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Alaska Bible College</td>\n      <td>2</td>\n      <td>8843</td>\n      <td>AK</td>\n      <td>27</td>\n      <td>Association for Bibical Higher Educaiton</td>\n      <td>0.333300</td>\n      <td>1</td>\n      <td>0</td>\n      <td>88.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Alaska Christian College</td>\n      <td>2</td>\n      <td>41386</td>\n      <td>AK</td>\n      <td>68</td>\n      <td>Association for Bibical Higher Educaiton</td>\n      <td>0.473700</td>\n      <td>1</td>\n      <td>0</td>\n      <td>37.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Ilisagvik College</td>\n      <td>1</td>\n      <td>34613</td>\n      <td>AK</td>\n      <td>109</td>\n      <td>Northwest Commission on Colleges and Universities</td>\n      <td>0.809500</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Charter College-Anchorage</td>\n      <td>3</td>\n      <td>25769</td>\n      <td>AK</td>\n      <td>3256</td>\n      <td>Accrediting Council for Independent Colleges a...</td>\n      <td>0.703723</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.310288</td>\n      <td>0.725806</td>\n      <td>0.417949</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Alaska Career College</td>\n      <td>3</td>\n      <td>25410</td>\n      <td>AK</td>\n      <td>479</td>\n      <td>Accrediting Commission of Career Schools and C...</td>\n      <td>0.794100</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.254237</td>\n      <td>0.556430</td>\n      <td>0.462520</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 46 columns</p>\n</div>","text/plain":"                        name  ownership  ope6_id state  size  \\\n0       Alaska Bible College          2     8843    AK    27   \n1   Alaska Christian College          2    41386    AK    68   \n2          Ilisagvik College          1    34613    AK   109   \n3  Charter College-Anchorage          3    25769    AK  3256   \n4      Alaska Career College          3    25410    AK   479   \n\n                                          accreditor  retention  branches  \\\n0           Association for Bibical Higher Educaiton   0.333300         1   \n1           Association for Bibical Higher Educaiton   0.473700         1   \n2  Northwest Commission on Colleges and Universities   0.809500         1   \n3  Accrediting Council for Independent Colleges a...   0.703723         1   \n4  Accrediting Commission of Career Schools and C...   0.794100         1   \n\n   online_only  religious_affil  ...  fafsa_sent  7_yr_repayment_completion  \\\n0            0             88.0  ...    0.463652                   0.699542   \n1            0             37.0  ...    0.463652                   0.699542   \n2            0             -2.0  ...    0.463652                   0.699542   \n3            0             -2.0  ...    0.310288                   0.725806   \n4            0             -2.0  ...    0.254237                   0.556430   \n\n   5_year_declining_balance  relig_y_n  accred_y_n  retention_listed_y_n  \\\n0                  0.496850          1           1                     1   \n1                  0.496850          1           1                     1   \n2                  0.496850          0           1                     1   \n3                  0.417949          0           1                     0   \n4                  0.462520          0           1                     1   \n\n   fac_salary_listed_y_n  7_yr_repayment_completion_y_n  \\\n0                      1                              0   \n1                      1                              0   \n2                      1                              0   \n3                      1                              1   \n4                      1                              1   \n\n   5_year_declining_balance_y_n  for_profit  \n0                             0           0  \n1                             0           0  \n2                             0           0  \n3                             1           1  \n4                             1           1  \n\n[5 rows x 46 columns]"},"exec_count":2,"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":3,"id":"7a8d7e","input":"X = df[['size','retention','branches', 'online_only', 'under_investigation', 'most_common_degree', 'highest_degree',\n       'faculty_salary', 'instructional_expenditure_per_fte',\n       'tuition_revenue_per_fte', 'part_time_share',\n       'age_entry', 'percent_dependent', 'first_generation', 'percent_black',\n        'avg_family_income','ind_low_income', 'dep_low_income', 'loan_principal',\n       'federal_loan_rate', 'students_with_any_loans',\n       'pell_grant_debt', 'percent_pell_grant',\n       'fafsa_sent', '7_yr_repayment_completion', '5_year_declining_balance',\n       'relig_y_n', 'accred_y_n', 'retention_listed_y_n',\n       'fac_salary_listed_y_n', '7_yr_repayment_completion_y_n',\n       '5_year_declining_balance_y_n', 'for_profit']]\nX.head()","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>size</th>\n      <th>retention</th>\n      <th>branches</th>\n      <th>online_only</th>\n      <th>under_investigation</th>\n      <th>most_common_degree</th>\n      <th>highest_degree</th>\n      <th>faculty_salary</th>\n      <th>instructional_expenditure_per_fte</th>\n      <th>tuition_revenue_per_fte</th>\n      <th>...</th>\n      <th>fafsa_sent</th>\n      <th>7_yr_repayment_completion</th>\n      <th>5_year_declining_balance</th>\n      <th>relig_y_n</th>\n      <th>accred_y_n</th>\n      <th>retention_listed_y_n</th>\n      <th>fac_salary_listed_y_n</th>\n      <th>7_yr_repayment_completion_y_n</th>\n      <th>5_year_declining_balance_y_n</th>\n      <th>for_profit</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>27</td>\n      <td>0.333300</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>3</td>\n      <td>2201</td>\n      <td>9585</td>\n      <td>8132</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>68</td>\n      <td>0.473700</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>5554</td>\n      <td>18174</td>\n      <td>12989</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>109</td>\n      <td>0.809500</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>6054</td>\n      <td>38265</td>\n      <td>3587</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3256</td>\n      <td>0.703723</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>3</td>\n      <td>4004</td>\n      <td>2617</td>\n      <td>8755</td>\n      <td>...</td>\n      <td>0.310288</td>\n      <td>0.725806</td>\n      <td>0.417949</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>479</td>\n      <td>0.794100</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>3861</td>\n      <td>4178</td>\n      <td>11905</td>\n      <td>...</td>\n      <td>0.254237</td>\n      <td>0.556430</td>\n      <td>0.462520</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 33 columns</p>\n</div>","text/plain":"   size  retention  branches  online_only  under_investigation  \\\n0    27   0.333300         1            0                    0   \n1    68   0.473700         1            0                    0   \n2   109   0.809500         1            0                    0   \n3  3256   0.703723         1            0                    0   \n4   479   0.794100         1            0                    0   \n\n   most_common_degree  highest_degree  faculty_salary  \\\n0                   3               3            2201   \n1                   1               2            5554   \n2                   1               2            6054   \n3                   1               3            4004   \n4                   1               2            3861   \n\n   instructional_expenditure_per_fte  tuition_revenue_per_fte  ...  \\\n0                               9585                     8132  ...   \n1                              18174                    12989  ...   \n2                              38265                     3587  ...   \n3                               2617                     8755  ...   \n4                               4178                    11905  ...   \n\n   fafsa_sent  7_yr_repayment_completion  5_year_declining_balance  relig_y_n  \\\n0    0.463652                   0.699542                  0.496850          1   \n1    0.463652                   0.699542                  0.496850          1   \n2    0.463652                   0.699542                  0.496850          0   \n3    0.310288                   0.725806                  0.417949          0   \n4    0.254237                   0.556430                  0.462520          0   \n\n   accred_y_n  retention_listed_y_n  fac_salary_listed_y_n  \\\n0           1                     1                      1   \n1           1                     1                      1   \n2           1                     1                      1   \n3           1                     0                      1   \n4           1                     1                      1   \n\n   7_yr_repayment_completion_y_n  5_year_declining_balance_y_n  for_profit  \n0                              0                             0           0  \n1                              0                             0           0  \n2                              0                             0           0  \n3                              1                             1           1  \n4                              1                             1           1  \n\n[5 rows x 33 columns]"},"exec_count":3,"output_type":"execute_result"}},"pos":4,"type":"cell"}
{"cell_type":"code","exec_count":3,"id":"e07653","input":"#insert 4","pos":14,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"58e2b2","input":"#insert 5","pos":16,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"cb73a6","input":"y = X.pop('for_profit')\n\nX_new = SelectKBest(chi2, k=2).fit(X, y)\n\nfeatures = []\nfor i, column in enumerate(X.columns):\n    features.append((X_new.pvalues_[i], column))\nfeatures.sort()\nprint('chi2-value', 'feature')\nfeatures","output":{"0":{"name":"stdout","output_type":"stream","text":"chi2-value feature\n"},"1":{"data":{"text/plain":"[(0.0, 'avg_family_income'),\n (0.0, 'branches'),\n (0.0, 'faculty_salary'),\n (0.0, 'instructional_expenditure_per_fte'),\n (0.0, 'loan_principal'),\n (0.0, 'pell_grant_debt'),\n (0.0, 'size'),\n (0.0, 'tuition_revenue_per_fte'),\n (5.339096890496358e-283, 'highest_degree'),\n (2.3550018048916394e-222, 'most_common_degree'),\n (5.4025502611485345e-149, 'fac_salary_listed_y_n'),\n (8.240679129762035e-148, 'relig_y_n'),\n (5.293172158552389e-143, 'age_entry'),\n (1.4125160311604572e-48, 'percent_dependent'),\n (1.429381130658807e-24, '5_year_declining_balance'),\n (1.3527931483014932e-21, 'federal_loan_rate'),\n (6.095800240149601e-17, 'percent_black'),\n (3.249757484508949e-15, 'fafsa_sent'),\n (2.3099399670292976e-10, '7_yr_repayment_completion'),\n (5.332261659651546e-09, 'first_generation'),\n (1.4079344574521532e-08, 'part_time_share'),\n (1.51637032044754e-08, 'dep_low_income'),\n (5.389960032435694e-08, 'percent_pell_grant'),\n (2.9423628117769607e-06, 'students_with_any_loans'),\n (9.035892891499908e-06, 'under_investigation'),\n (0.006314439338573356, 'retention_listed_y_n'),\n (0.012536378966747178, 'online_only'),\n (0.01746153785302311, 'ind_low_income'),\n (0.5021649291685133, '5_year_declining_balance_y_n'),\n (0.6158853388832327, 'retention'),\n (0.8250416943743915, 'accred_y_n'),\n (0.9230148052834302, '7_yr_repayment_completion_y_n')]"},"exec_count":4,"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":6,"id":"e1b3d1","input":"#insert 6","pos":18,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"d6a5e7","input":"#insert 8","pos":22,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"0b5f5a","input":"#insert 7","pos":20,"type":"cell"}
{"cell_type":"code","id":"015424","input":"#insert 10","pos":26,"type":"cell"}
{"cell_type":"code","id":"3d96cb","input":"# insert 12","pos":30,"type":"cell"}
{"cell_type":"code","id":"4a73c4","input":"#insert 9","pos":24,"type":"cell"}
{"cell_type":"code","id":"55d4e5","input":"","pos":34,"type":"cell"}
{"cell_type":"code","id":"57df25","input":"#insert 13","pos":32,"type":"cell"}
{"cell_type":"code","id":"8127c8","input":"#insert 11","pos":28,"type":"cell"}
{"cell_type":"code","id":"e4edf8","input":"#insert 1","pos":8,"type":"cell"}
{"cell_type":"markdown","collapsed":true,"id":"c2c5fd","input":"7.Using the logarithmic regression model, plot a decision boundary between instructional_expenditure_per_fte and 5_year_declining_balance. Does it appear that for-profit status has a clear boundary based on these predictors?","pos":19,"type":"cell"}
{"cell_type":"markdown","id":"11e620","input":"1.Based on the info above, what was intuitive? What was surprising? How big (or small) of an effect does accredition have on for-profit status? What might be some guesses as to why this is the case?","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"23b698","input":"5.Print a confusion matrix and describe what it means in your context.","pos":15,"type":"cell"}
{"cell_type":"markdown","id":"63ecc8","input":"4.Run a classification report and describe in detail what the terms mean in the context of your model.","pos":13,"type":"cell"}
{"cell_type":"markdown","id":"67bcd5","input":"10. Make a comparative ROC plot of the naive bayes, logistic, gradient boosting, KNN classifiers, random forest, and SVM classifiers.","pos":25,"type":"cell"}
{"cell_type":"markdown","id":"6f3978","input":"We are going to use classification algorithms to try to predict for-profit or non-profit status. \n\nSome of the categories aren't applicable to what we want to do so let's consider the following columns only:\n","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"721c32","input":"12.What are the worst schools? Some of them are chains of schools so don't necessarily consider singular names but generalize to chains. Give a lot of justification for your analysis as everyone might have a different answer here. Insert these responses into your blog.","pos":29,"type":"cell"}
{"cell_type":"markdown","id":"765a4d","input":"9.Support vector machines are another type of classifier. Read the docs [here](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html) and then try implementing that one.","pos":23,"type":"cell"}
{"cell_type":"markdown","id":"7a6a42","input":"2.Do a test/train split and give the testing accuracy error for logistic regression.","pos":9,"type":"cell"}
{"cell_type":"markdown","id":"95c8b9","input":"13.If you were a governmental organization overseeing accreditation, what factors would be most important to you in making sure that the college was non-predatory? Give a lot of detail here as well in your blog.","pos":31,"type":"cell"}
{"cell_type":"markdown","id":"bcf3b5","input":"11.Take in a new school's data and predict the school's profit status using one of your previous classifier methods.","pos":27,"type":"cell"}
{"cell_type":"markdown","id":"c354f2","input":"6.Make a comparative ROC plot of the naive bayes, logistic, gradient boosting, and KNN classifiers.","pos":17,"type":"cell"}
{"cell_type":"markdown","id":"c62b44","input":"14.Read several articles on college predatory practices and cite and incorporate them into your blog discussion. Remember to link to them clearly by using the \n```[here](http://....)``` syntax.","pos":33,"type":"cell"}
{"cell_type":"markdown","id":"d2fa47","input":"I pulled and cleaned a comprehensive dataset of colleges from this governmental database:\n    \nhttps://collegescorecard.ed.gov/data/\n\nLet's read this dataset in:","pos":1,"type":"cell"}
{"cell_type":"markdown","id":"d35f8a","input":"Let's first use a method called [SelectKBest](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html) to see which features have the most statistically significant relationships with profit status. The **lower** the p value, the **more** statistically significant:","pos":5,"type":"cell"}
{"cell_type":"markdown","id":"da0287","input":"8.We have not covered random forests but they are a very popular type of classifier. It is very good practice in reading the docs to get a new classifier working. Read [this](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html) and then apply the RandomForestClassifier().","pos":21,"scrolled":true,"type":"cell"}
{"cell_type":"markdown","id":"e24dfb","input":"3.Find the optimal number of nearest neighbors for KNN using grid search and then give the test accuracy. ","pos":11,"type":"cell"}
{"last_load":1572992143879,"type":"file"}